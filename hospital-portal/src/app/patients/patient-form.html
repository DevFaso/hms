<div class="page-container">
  <div class="page-header">
    <div>
      <h1 class="page-title">Register Patient</h1>
      <p class="page-subtitle">Add a new patient to the system</p>
    </div>
    <a routerLink="/patients" class="btn-secondary">
      <span class="material-symbols-outlined">arrow_back</span>
      Back to Patients
    </a>
  </div>

  <form class="form-card" (ngSubmit)="onSubmit()">
    <div class="form-grid">
      <div class="form-group">
        <label for="firstName">First Name *</label>
        <input id="firstName" type="text" [(ngModel)]="form.firstName" name="firstName" required />
      </div>
      <div class="form-group">
        <label for="middleName">Middle Name</label>
        <input id="middleName" type="text" [(ngModel)]="form.middleName" name="middleName" />
      </div>
      <div class="form-group">
        <label for="lastName">Last Name *</label>
        <input id="lastName" type="text" [(ngModel)]="form.lastName" name="lastName" required />
      </div>
      <div class="form-group">
        <label for="email">Email *</label>
        <input id="email" type="email" [(ngModel)]="form.email" name="email" required />
      </div>
      <div class="form-group">
        <label for="phonePrimary">Phone Number *</label>
        <input
          id="phonePrimary"
          type="tel"
          [(ngModel)]="form.phoneNumberPrimary"
          name="phoneNumberPrimary"
          required
        />
      </div>
      <div class="form-group">
        <label for="phoneSecondary">Secondary Phone</label>
        <input
          id="phoneSecondary"
          type="tel"
          [(ngModel)]="form.phoneNumberSecondary"
          name="phoneNumberSecondary"
        />
      </div>
      <div class="form-group">
        <label for="dob">Date of Birth *</label>
        <input id="dob" type="date" [(ngModel)]="form.dateOfBirth" name="dateOfBirth" required />
      </div>
      <div class="form-group">
        <label for="gender">Gender *</label>
        <select id="gender" [(ngModel)]="form.gender" name="gender" required>
          <option value="">Select gender</option>
          <option value="MALE">Male</option>
          <option value="FEMALE">Female</option>
          <option value="OTHER">Other</option>
        </select>
      </div>
      <div class="form-group">
        <label for="bloodType">Blood Type</label>
        <select id="bloodType" [(ngModel)]="form.bloodType" name="bloodType">
          <option value="">Select blood type</option>
          <option value="A+">A+</option>
          <option value="A-">A-</option>
          <option value="B+">B+</option>
          <option value="B-">B-</option>
          <option value="AB+">AB+</option>
          <option value="AB-">AB-</option>
          <option value="O+">O+</option>
          <option value="O-">O-</option>
        </select>
      </div>
      <div class="form-group">
        <label for="hospital">Hospital *</label>
        <select id="hospital" [(ngModel)]="form.hospitalId" name="hospitalId" required>
          <option value="">Select hospital</option>
          @for (h of hospitals; track h.id) {
            <option [value]="h.id">{{ h.name }}</option>
          }
        </select>
      </div>

      <div class="form-group full-width section-divider">
        <h3 class="section-title">Location</h3>
      </div>
      <div class="form-group">
        <label for="country">Country *</label>
        <input
          id="country"
          type="text"
          [(ngModel)]="form.country"
          name="country"
          required
          placeholder="e.g., Burkina Faso, USA, France"
        />
      </div>
      <div class="form-group">
        <label for="city">Ville / City *</label>
        <input
          id="city"
          type="text"
          [(ngModel)]="form.city"
          name="city"
          required
          placeholder="e.g., Ouagadougou, Paris, New York"
        />
      </div>
      <div class="form-group">
        <label for="state">Province / Region</label>
        <input
          id="state"
          type="text"
          [(ngModel)]="form.state"
          name="state"
          placeholder="e.g., Kadiogo, ÃŽle-de-France, California"
        />
      </div>
      <div class="form-group">
        <label for="address">Secteur / Neighborhood</label>
        <input
          id="address"
          type="text"
          [(ngModel)]="form.address"
          name="address"
          placeholder="e.g., Secteur 30, Quartier Dassasgho"
        />
      </div>
      <div class="form-group">
        <label for="zipCode">Code Postal / Zip Code</label>
        <input
          id="zipCode"
          type="text"
          [(ngModel)]="form.zipCode"
          name="zipCode"
          placeholder="Optional"
        />
      </div>

      <div class="form-group full-width section-divider">
        <h3 class="section-title">Emergency Contact</h3>
      </div>
      <div class="form-group">
        <label for="ecName">Contact Name</label>
        <input
          id="ecName"
          type="text"
          [(ngModel)]="form.emergencyContactName"
          name="emergencyContactName"
        />
      </div>
      <div class="form-group">
        <label for="ecPhone">Contact Phone</label>
        <input
          id="ecPhone"
          type="tel"
          [(ngModel)]="form.emergencyContactPhone"
          name="emergencyContactPhone"
        />
      </div>
      <div class="form-group">
        <label for="ecRelation">Relationship</label>
        <input
          id="ecRelation"
          type="text"
          [(ngModel)]="form.emergencyContactRelationship"
          name="emergencyContactRelationship"
          placeholder="e.g., Spouse, Parent, Sibling"
        />
      </div>

      <div class="form-group full-width section-divider">
        <h3 class="section-title">Medical Information</h3>
      </div>
      <div class="form-group full-width">
        <label for="allergies">Allergies</label>
        <textarea
          id="allergies"
          [(ngModel)]="form.allergies"
          name="allergies"
          rows="2"
          placeholder="Known allergies..."
        ></textarea>
      </div>
      <div class="form-group full-width">
        <label for="medicalHistory">Medical History Summary</label>
        <textarea
          id="medicalHistory"
          [(ngModel)]="form.medicalHistorySummary"
          name="medicalHistorySummary"
          rows="3"
          placeholder="Relevant medical history..."
        ></textarea>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn-primary" [disabled]="saving">
        @if (saving) {
          <span class="spinner-sm"></span>
        }
        Register Patient
      </button>
      <a routerLink="/patients" class="btn-secondary">Cancel</a>
    </div>
  </form>
</div>
