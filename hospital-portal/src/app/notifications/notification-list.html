<div class="page-container">
  <div class="page-header">
    <div>
      <h1 class="page-title">Notifications</h1>
      <p class="page-subtitle">{{ unreadCount() }} unread notifications</p>
    </div>
    @if (unreadCount() > 0) {
      <button class="btn-secondary" (click)="markAllRead()">
        <span class="material-symbols-outlined">done_all</span>
        Mark all read
      </button>
    }
  </div>

  <!-- Filters -->
  <div class="tabs">
    <button class="tab" [class.active]="activeFilter() === 'all'" (click)="setFilter('all')">
      All
    </button>
    <button class="tab" [class.active]="activeFilter() === 'unread'" (click)="setFilter('unread')">
      Unread
    </button>
    <button class="tab" [class.active]="activeFilter() === 'read'" (click)="setFilter('read')">
      Read
    </button>
  </div>

  @if (loading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Loading notifications...</p>
    </div>
  }

  @if (!loading() && filtered().length > 0) {
    <div class="notification-list">
      @for (notif of filtered(); track notif.id) {
        <button
          class="notif-card"
          [class.unread]="!notif.read"
          (click)="markRead(notif)"
          (keydown.enter)="markRead(notif)"
          type="button"
        >
          <div class="notif-icon-wrap" [class]="getTypeClass(notif.type)">
            <span class="material-symbols-outlined">{{ getTypeIcon(notif.type) }}</span>
          </div>
          <div class="notif-content">
            <h4 class="notif-title">{{ notif.title }}</h4>
            <p class="notif-message">{{ notif.message }}</p>
            <span class="notif-time">{{ notif.createdAt | date: 'medium' }}</span>
          </div>
          @if (!notif.read) {
            <div class="unread-dot"></div>
          }
        </button>
      }
    </div>
  }

  @if (!loading() && filtered().length === 0) {
    <div class="empty-state">
      <span class="material-symbols-outlined empty-icon">notifications_off</span>
      <h3>No notifications</h3>
      <p>{{ activeFilter() === 'unread' ? 'All caught up!' : 'Nothing here yet.' }}</p>
    </div>
  }
</div>
